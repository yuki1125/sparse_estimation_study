### 問題1


$$\left(
\begin{matrix}
\frac{\partial}{\partial \beta_1}\Sigma_{i=1}^N(y_i - \Sigma_{k=1}^p\beta_kx_{i,k})^2  \\
\vdots & \\
\frac{\partial}{\partial \beta_p}\Sigma_{i=1}^N(y_i - \Sigma_{k=1}^p\beta_kx_{i,k})^2
\end{matrix}
\right)
= -2X^T(y-X\beta)$$

左辺一行目に注目する。

$$\frac{\partial}{\partial \beta_1}\Sigma_{i=1}^N(y_i-\Sigma_{k=1}^p\beta_kx_{i,k})^2$$

$\beta_1$で微分すると、

$$-2\Sigma_{i=1}^Nx_{i,1}(y_i-\Sigma_{k=1}^p\beta_kx_{i,k})$$

となる。
（$x_{i,1}$だけが残っているのは、$\beta_{i\neq1}$以外は消えたから）。

他の二行目、三行目についても同様の式が得られる。
これを行列の形に変形すると、

$$-2\left(
\begin{matrix}
x_{1,1} \cdots x_{N,1} \\
\vdots  \ddots \vdots \\
x_{1,p} \cdots x_{N,p}
\end{matrix}
\right)
\left(
\begin{matrix}
y_1-\Sigma_{k=1}^p\beta_kx_{1,k} \\
\vdots \\
y_N-\Sigma_{k=1}^p\beta_kx_{N,k} \\
\end{matrix}
\right)$$

となり、更に単純な形に直すと、

$$-2X^T(y-X\beta)$$

と書ける。

更に、$-2X^T(y-X\beta)=0$とした時、

$$-2X^Ty + 2X^TX\beta=0$$

$$2X^Ty = 2X^TX\beta$$

$$X^Ty = X^TX\beta$$

$$\beta = (X^TX)^{-1}X^Ty$$

となり、$X^TX$が正則なときに$\Sigma_{i=1}^N(y_i-\Sigma_{k=1}^p\beta_1x_{i,k})^2$を最小にする$\beta$が上式から求まることがわかる。


---
### 問題2

$$f(\alpha x+(1-\alpha)y)\leq \alpha f(x)+(1-\alpha)f(y)$$
が成立する時、$f$は下に凸である。（ただし$\alpha$は任意の$0 < \alpha < 1$)

例えば、関数$f(x)=x$は凸関数である。
なぜなら、

上式より、
$$\alpha x+(1-\alpha)y \leq\alpha x+(1-\alpha)y$$
が成り立つためである。

また$x_0 \in \R$について、$x_0 = 0$の時の、
$$f(x) \geq f(x_0)+z(x-x_0)$$
が成立する$z \in \R$の集合、劣微分、を求める。

関数$f(x)=x$は微分可能であるため、$z$は$f'(x_0)$の1要素のみから成る集合となる。
したがって$z=1$となる。

また関数$f(x)=|x|$の場合も、
$$|\alpha x+(1-\alpha)y|\leq \alpha |x|+(1-\alpha)|y|$$
が成立する。

これは直感的に、左辺の場合、$x$や$y$の正負によって値が変化するが、右辺では常に$x$と$y$が正の値をとるため、どのような場合でも左辺以下の値になることはないことがわかる。
実際に、右辺の二乗から左辺の二乗を引くと、

$$2\alpha(1-\alpha)(|xy|-xy) \geq 0$$
となる。

また、

$$f(x) \geq f(x_0)+z(x-x_0)$$

より、$x_0=0$のとき、
$$|x| \geq zx$$
となる。これを見たす$z$の集合が$f(x)=|x|$の劣微分となる。（繰り返しだが、劣微分は劣勾配を要素とする集合)
これを満たす、$z$は$-1 \leq z \leq +1$の間であるとわかる。
任意の$x$で$|x| \geq zx$であれば$x>0$では$z \leq 1$が、$x<0$では$z \geq-1$が成り立つ。

---
### 問題3
(a) 関数$f$、$g$が凸であれば、任意の$\beta$、$\gamma \geq 1$に対して
関数$\beta f(x) + \gamma g(x)$も凸となる。
これは

$$
\beta(f(\alpha x+(1-\alpha)y) + g(\alpha x+(1-\alpha)y))
$$
$$
\geq\alpha\beta f(x) + (1-\alpha)\beta f(y) + \alpha\gamma g(x) + (1-\alpha)\gamma g(y)
$$
$$
=\alpha(\beta f(x) + \gamma g(x)) + (1-\alpha)(\beta f(y) + \gamma g(y))
$$

が成り立つち、凸関数であることがわかる。

(b)

$$f(x) = 
\begin{cases}
1, & x \neq 0 \\
0, & x = 0
\end{cases}$$

この関数の場合は、
$$f(\alpha x +(1-\alpha)y) \leq \alpha f(x) + (1-\alpha)f(y)$$
に対して、例えば $x=0$、$y \neq 0$の時、
左辺は
$$f(\alpha *0 +(1-\alpha)*1)=f(1-\alpha)=1$$

右辺は
$$\alpha f(0)+(1-\alpha)f(1) = 1-\alpha$$
となる。
この場合、
$$1 > 1-\alpha$$
となるため、凸関数の条件

$$f(\alpha x +(1-\alpha)y) \leq \alpha f(x) + (1-\alpha)f(y)$$

が成り立たないため、凸関数ではないことがわかる。

(c)
$$||y-X\beta||^2$$
についてまず考えると、$X\beta$は関数$f(\beta)=X\beta$と考えられ、
その自乗誤差は$beta$の二次関数（線形関数）なので凸であるとわかる。

次に$$||\beta||_0$$について考えると

$$f(\beta) = 
\begin{cases}
1, & \beta \neq 0 \\
0, & \beta = 0
\end{cases}$$

であり、すでに(b)で凸関数ではないと証明した。
したがって、$$\frac{1}{2N}||y-X\beta||^2 + ||\beta||_0$$
は凸関数ではないとわかる。

次に

$$\frac{1}{2N}||y-X\beta||^2 + ||\beta||_1$$

は、$||\beta||_1$が問題2より凸であると分かっているので
凸関数であるとわかる。

$$||\beta||_2^2$$

は$f(\beta)=\beta^2$であり、

$$(\alpha x+(1-\alpha)y)^2\leq \alpha x^2+(1-\alpha)y^2$$

は常に成り立つことがわかる。
なぜなら、$0 \leq \alpha \leq 1$であり、$x^2, y^2$であるから
右辺は負の値を取らず、左辺は$x, y$が負の可能性もあり、かつ、$\alpha$も2乗されてしまうためである。

---
問題4

(a)
$$f(x) \geq f(x_0)+f'(x)(x-x_0)$$
を導く。

まず凸関数の条件

$$f(\alpha x +(1-\alpha)x_0) \leq \alpha f(x) +(1-\alpha)f(x_0)$$

を変形して、
$f(x)=$の形にすると

$$f(x) \geq \frac{f(\alpha x+(1-\alpha)x_0)-(1-\alpha)f(x_0)}{\alpha}$$
$$=\frac{f(x_0+\alpha(x-x_0))}{\alpha} - \frac{(1-\alpha)f(x_0)}{\alpha}$$
$$=\frac{f(x_0+\alpha(x-x_0))}{\alpha} - \frac{f(x_0)-\alpha f(x_0)}{\alpha}$$

$$=\frac{f(x_0+\alpha(x-x_0)) - f(x_0)}{\alpha} + f(x_0)$$

$$= f(x_0)+\frac{f(x_0+\alpha(x-x_0)) - f(x_0)}{\alpha (x-x_0)}(x-x_0)$$

$$\lim_{\alpha \to 0} \frac{f(x_0+\alpha(x-x_0)) - f(x_0)}\alpha (x-x_0) = f'(x_0)$$

となるため、
$$f(x) \geq f(x_0)+f'(x)(x-x_0)$$
が成り立つ。