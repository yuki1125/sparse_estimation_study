## 1. 次式の2個の等号が成立することを証明せよ。


$$\left(
\begin{matrix}
\frac{\partial}{\partial \beta_1}\Sigma_{i=1}^N(y_i - \Sigma_{k=1}^p\beta_kx_{i,k})^2  \\
\vdots & \\
\frac{\partial}{\partial \beta_p}\Sigma_{i=1}^N(y_i - \Sigma_{k=1}^p\beta_kx_{i,k})^2
\end{matrix}
\right)
= -2X^T(y-X\beta)$$

左辺一行目に注目する。

$$\frac{\partial}{\partial \beta_1}\Sigma_{i=1}^N(y_i-\Sigma_{k=1}^p\beta_kx_{i,k})^2$$

$\beta_1$で微分すると、

$$-2\Sigma_{i=1}^Nx_{i,1}(y_i-\Sigma_{k=1}^p\beta_kx_{i,k})$$

となる。
（$x_{i,1}$だけが残っているのは、$\beta_{i\neq1}$以外は消えたから）。

他の二行目、三行目についても同様の式が得られる。
これを行列の形に変形すると、

$$-2\left(
\begin{matrix}
x_{1,1} \cdots x_{N,1} \\
\vdots  \ddots \vdots \\
x_{1,p} \cdots x_{N,p}
\end{matrix}
\right)
\left(
\begin{matrix}
y_1-\Sigma_{k=1}^p\beta_kx_{1,k} \\
\vdots \\
y_N-\Sigma_{k=1}^p\beta_kx_{N,k} \\
\end{matrix}
\right)$$

となり、更に単純な形に直すと、

$$-2X^T(y-X\beta)$$

と書ける。

更に、$-2X^T(y-X\beta)=0$とした時、

$$-2X^Ty + 2X^TX\beta=0$$
$$2X^Ty = 2X^TX\beta$$
$$X^Ty = X^TX\beta$$
$$\beta = (X^TX)^{-1}X^Ty$$

となり、$X^TX$が正則なときに$\Sigma_{i=1}^N(y_i-\Sigma_{k=1}^p\beta_1x_{i,k})^2$を最小にする$\beta$が上式から求まることがわかる。